import { Doc, applyUpdate } from "yjs";
export default class YDocHandler {
    constructor(docName, docOptions = { gc: true }) {
        this.feedOptions = {
            valueEncoding: "binary",
        };
        this.kind = docName;
        this.doc = new Doc(docOptions);
        this.doc.on("update", (update, origin) => {
            const isFeedOrigin = typeof origin === "string" && origin.length === 64;
            if (!isFeedOrigin) {
                // console.log("local update", update);
                this.defaultFeed.append(Buffer.from(update));
            }
        });
    }
    handleMessage(feed, msg) {
        // console.log("remote update", msg, feed.key);
        applyUpdate(this.doc, msg, feed.key);
    }
}
