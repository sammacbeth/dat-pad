{"version":3,"file":"y-codemirror.cjs","sources":["../src/y-codemirror.js"],"sourcesContent":["/**\n * @module bindings/textarea\n */\n\nimport { createMutex } from 'lib0/mutex.js'\nimport * as math from 'lib0/math.js'\nimport * as Y from 'yjs'\nimport * as func from 'lib0/function.js'\n\n/**\n * @param {CodemirrorBinding} binding\n * @param {any} event\n */\nconst typeObserver = (binding, event) => {\n  binding._mux(() => {\n    const cmDoc = binding.cmDoc\n    const cm = cmDoc.getEditor()\n    const performChange = () => {\n      const delta = event.delta\n      let index = 0\n      for (let i = 0; i < event.delta.length; i++) {\n        const d = delta[i]\n        if (d.retain) {\n          index += d.retain\n        } else if (d.insert) {\n          const pos = cmDoc.posFromIndex(index)\n          cmDoc.replaceRange(d.insert, pos, pos, 'prosemirror-binding')\n          index += d.insert.length\n        } else if (d.delete) {\n          const start = cmDoc.posFromIndex(index)\n          const end = cmDoc.posFromIndex(index + d.delete)\n          cmDoc.replaceRange('', start, end, 'prosemirror-binding')\n        }\n      }\n    }\n    // if possible, bundle the changes using cm.operation\n    if (cm) {\n      cm.operation(performChange)\n    } else {\n      performChange()\n    }\n  })\n}\n\nconst targetObserver = (binding, change) => {\n  binding._mux(() => {\n    binding.doc.transact(() => {\n      const start = binding.cmDoc.indexFromPos(change.from)\n      const delLen = change.removed.map(s => s.length).reduce(math.add) + change.removed.length - 1\n      if (delLen > 0) {\n        binding.type.delete(start, delLen)\n      }\n      if (change.text.length > 0) {\n        binding.type.insert(start, change.text.join('\\n'))\n      }\n    }, binding)\n  })\n}\n\nconst createRemoteCaret = (username, color) => {\n  const caret = document.createElement('span')\n  caret.classList.add('remote-caret')\n  caret.setAttribute('style', `border-color: ${color}`)\n  const userDiv = document.createElement('div')\n  userDiv.setAttribute('style', `background-color: ${color}`)\n  userDiv.insertBefore(document.createTextNode(username), null)\n  caret.insertBefore(userDiv, null)\n  setTimeout(() => {\n    caret.classList.add('hide-name')\n  }, 2000)\n  return caret\n}\n\nconst updateRemoteSelection = (y, cm, type, cursors, clientId, awareness) => {\n  // redraw caret and selection for clientId\n  const aw = awareness.getStates().get(clientId)\n  // destroy current text mark\n  const m = cursors.get(clientId)\n  if (m !== undefined) {\n    m.caret.clear()\n    if (m.sel !== null) {\n      m.sel.clear()\n    }\n    cursors.delete(clientId)\n  }\n  if (aw === undefined) {\n    return\n  }\n  const user = aw.user || {}\n  if (user.color == null) {\n    user.color = '#ffa500'\n  }\n  if (user.name == null) {\n    user.name = `User: ${clientId}`\n  }\n  const cursor = aw.cursor\n  if (cursor == null || cursor.anchor == null || cursor.head == null) {\n    return\n  }\n  const anchor = Y.createAbsolutePositionFromRelativePosition(JSON.parse(cursor.anchor), y)\n  const head = Y.createAbsolutePositionFromRelativePosition(JSON.parse(cursor.head), y)\n  if (anchor !== null && head !== null && anchor.type === type && head.type === type) {\n    const headpos = cm.posFromIndex(head.index)\n    const anchorpos = cm.posFromIndex(anchor.index)\n    let from, to\n    if (head.index < anchor.index) {\n      from = headpos\n      to = anchorpos\n    } else {\n      from = anchorpos\n      to = headpos\n    }\n    const caretEl = createRemoteCaret(user.name, user.color)\n    // if position was \"relatively\" the same, do not show name again and hide instead\n    if (m && func.equalityFlat(aw.cursor.anchor, m.awCursor.anchor) && func.equalityFlat(aw.cursor.head, m.awCursor.head)) {\n      caretEl.classList.add('hide-name')\n    }\n    const caret = cm.setBookmark(headpos, { widget: caretEl, insertLeft: true })\n    let sel = null\n    if (head.index !== anchor.index) {\n      sel = cm.markText(from, to, { css: `background-color: ${user.color}70`, inclusiveRight: true, inclusiveLeft: false })\n    }\n    cursors.set(clientId, { caret, sel, awCursor: cursor })\n  }\n}\n\nconst codemirrorCursorActivity = (y, cm, type, awareness) => {\n  const aw = awareness.getLocalState()\n  if (!cm.hasFocus() || aw == null) {\n    return\n  }\n  const newAnchor = Y.createRelativePositionFromTypeIndex(type, cm.indexFromPos(cm.getCursor('anchor')))\n  const newHead = Y.createRelativePositionFromTypeIndex(type, cm.indexFromPos(cm.getCursor('head')))\n  let currentAnchor = null\n  let currentHead = null\n  if (aw.cursor != null) {\n    currentAnchor = Y.createRelativePositionFromJSON(JSON.parse(aw.cursor.anchor))\n    currentHead = Y.createRelativePositionFromJSON(JSON.parse(aw.cursor.head))\n  }\n  if (aw.cursor == null || !Y.compareRelativePositions(currentAnchor, newAnchor) || !Y.compareRelativePositions(currentHead, newHead)) {\n    awareness.setLocalStateField('cursor', {\n      anchor: JSON.stringify(newAnchor),\n      head: JSON.stringify(newHead)\n    })\n  }\n}\n\n/**\n * A binding that binds a YText to a CodeMirror editor.\n *\n * @example\n *   const ytext = ydocument.define('codemirror', Y.Text)\n *   const editor = new CodeMirror(document.querySelector('#container'), {\n *     mode: 'javascript',\n *     lineNumbers: true\n *   })\n *   const binding = new CodemirrorBinding(ytext, editor)\n *\n */\nexport class CodemirrorBinding {\n  /**\n   * @param {Y.Text} textType\n   * @param {import('codemirror').Editor} codeMirror\n   * @param {any} [awareness]\n   */\n  constructor (textType, codeMirror, awareness) {\n    const doc = textType.doc\n    const cmDoc = codeMirror.getDoc()\n    this.doc = doc\n    this.type = textType\n    this.cm = codeMirror\n    this.cmDoc = cmDoc\n    this.awareness = awareness\n    // this.undoManager = new Y.UndoManager(textType, { trackedOrigins: new Set([this]) })\n    this._mux = createMutex()\n    // set initial value\n    cmDoc.setValue(textType.toString())\n    // observe type and target\n    this._typeObserver = event => typeObserver(this, event)\n    this._targetObserver = (_, change) => targetObserver(this, change)\n    this._cursors = new Map()\n    this._awarenessListener = event => {\n      if (codeMirror.getDoc() !== cmDoc) {\n        return\n      }\n      const f = clientId => {\n        if (clientId !== doc.clientID) {\n          updateRemoteSelection(doc, codeMirror, textType, this._cursors, clientId, awareness)\n        }\n      }\n\n      event.added.forEach(f)\n      event.removed.forEach(f)\n      event.updated.forEach(f)\n    }\n    this._cursorListener = () => {\n      if (codeMirror.getDoc() === cmDoc) {\n        codemirrorCursorActivity(doc, codeMirror, textType, awareness)\n      }\n    }\n    this._blurListeer = () => awareness.setLocalStateField('cursor', null)\n\n    textType.observe(this._typeObserver)\n    // @ts-ignore\n    cmDoc.on('change', this._targetObserver)\n    if (awareness) {\n      codeMirror.on('swapDoc', this._blurListeer)\n      awareness.on('change', this._awarenessListener)\n      // @ts-ignore\n      cmDoc.on('cursorActivity', this._cursorListener)\n      codeMirror.on('blur', this._blurListeer)\n      codeMirror.on('focus', this._cursorListener)\n    }\n  }\n\n  destroy () {\n    this.type.unobserve(this._typeObserver)\n    this.cm.off('swapDoc', this._blurListeer)\n    // @ts-ignore\n    this.cmDoc.off('change', this._targetObserver)\n    this.cm.off('cursorActivity', this._cursorListener)\n    this.cm.off('focus', this._cursorListener)\n    this.cm.off('blur', this._blurListeer)\n    this.awareness.off('change', this._awarenessListener)\n    this.type = null\n    this.cm = null\n    this.cmDoc = null\n    // this.undoManager.destroy()\n  }\n}\n\nexport const CodeMirrorBinding = CodemirrorBinding\n"],"names":["math.add","Y.createAbsolutePositionFromRelativePosition","func.equalityFlat","Y.createRelativePositionFromTypeIndex","Y.createRelativePositionFromJSON","Y.compareRelativePositions","createMutex"],"mappings":"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"}